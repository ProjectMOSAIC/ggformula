<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Formula Interface for ggplot2 (full version) • ggformula</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../../favicon.ico">
<link rel="manifest" href="../../site.webmanifest">
<script src="../../lightswitch.js"></script><script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../../deps/headroom-0.11.0/headroom.min.js"></script><script src="../../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../../deps/search-1.0.0/fuse.min.js"></script><script src="../../deps/search-1.0.0/mark.min.js"></script><script src="ggformula-long_files/libs/quarto-html/popper.min.js"></script><script src="ggformula-long_files/libs/quarto-html/tippy.umd.min.js"></script><link href="ggformula-long_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="ggformula-long_files/libs/quarto-html/light-border.css" rel="stylesheet">
<!-- pkgdown --><script src="../../pkgdown.js"></script><meta property="og:title" content="Formula Interface for ggplot2 (full version)">
<meta property="og:image" content="/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../../index.html">ggformula</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../../articles/ggformula.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../../articles/pkgdown/ggformula-blog.html">ggformula: Another Option for Teaching Graphics in R to Beginners</a></li>
    <li><a class="dropdown-item" href="../../articles/pkgdown/ggformula-long.html">Formula Interface for ggplot2 (full version)</a></li>
    <li><a class="dropdown-item" href="../../articles/interactive-graphics.html">Interactive graphics with {ggformula}</a></li>
    <li><a class="dropdown-item" href="../../articles/pkgdown/learn-more.html">Learn More About ggformula</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials">
<li><a class="dropdown-item" href="../../tutorials/introduction.html">Plotting with Formulas</a></li>
    <li><a class="dropdown-item" href="../../tutorials/refining.html">Refining ggformula Plots</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ProjectMOSAIC/ggformula/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../../logo.png" class="logo" alt=""><h1>Formula Interface for ggplot2 (full version)</h1>

      <p class="author">Daniel Kaplan and Randall Pruim</p>
      <p class="date">2020-07-01</p>

      <small class="dont-index">Source: <a href="https://github.com/ProjectMOSAIC/ggformula/blob/HEAD/vignettes/pkgdown/ggformula-long.qmd" class="external-link"><code>vignettes/pkgdown/ggformula-long.qmd</code></a></small>
      <div class="d-none name"><code></code></div>
    </div>






    <section class="section level2"><h2 id="formula-driven-graphics">Formula-driven graphics<a class="anchor" aria-label="anchor" href="#formula-driven-graphics"></a>
</h2>
<p>There are several excellent graphics packages provided for R. The <code>ggformula</code> package currently builds on one of them, <code>ggplot2</code>, but provides a very different user interface for creating plots. The interface is based on formulas (much like the <code>lattice</code> interface) and the use of the chaining operator (<code>|&gt;</code>) to build more complex graphics from simpler components.</p>
<p>The <code>ggformula</code> graphics were designed with several user groups in mind:</p>
<ul>
<li><p>beginners who want to get started quickly and may find the syntax of <code>ggplot2()</code> a bit offputting,</p></li>
<li><p>those familiar with <code>lattice</code> graphics, but wanting to be able to easily create multilayered plots,</p></li>
<li><p>those who prefer a formula interface, perhaps because it is familiar from use with functions like <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> or from use of the <code>mosaic</code> package for numerical summaries.</p></li>
</ul>
<section class="level2"><h3 id="the-basic-formula-template">The basic formula template<a class="anchor" aria-label="anchor" href="#the-basic-formula-template"></a>
</h3>
<p>The basic template for creating a plot with <code>ggformula</code> is</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gf_plottype</span><span class="op">(</span><span class="va">formula</span>, data <span class="op">=</span> <span class="va">mydata</span><span class="op">)</span></span></code></pre></div>
</div>
<p>or, equivalently,</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mydata</span> <span class="op">|&gt;</span> <span class="fu">gf_plottype</span><span class="op">(</span><span class="va">formula</span><span class="op">)</span></span></code></pre></div>
</div>
<p>where</p>
<ul>
<li><p><code>plottype</code> describes the type of plot (layer) desired (points, lines, a histogram, etc., etc.),</p></li>
<li><p><code>mydata</code> is a data frame containing the variables used in the plot, and</p></li>
<li><p><code>formula</code> describes how/where those variables are used.</p></li>
</ul>
<p>For example, in a bivariate plot, <code>formula</code> will take the form <code>y ~ x</code>, where <code>y</code> is the name of a variable to be plotted on the y-axis and <code>x</code> is the name of a variable to be plotted on the x-axis. (It is also possible to use expressions that can be evaluated using variables in the data frame as well.)</p>
<p>The first form of the tempate is useful for simple plots or for multi-layered plots where different layers use different data. The second form is useful for multi-layered plots or plots with many arguments.</p>
<p>Here is a simple example:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ProjectMOSAIC/ggformula" class="external-link">ggformula</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/gf_point.html">gf_point</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">hp</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/simple-example-1.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/gf_point.html">gf_point</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">hp</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/simple-example-2.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
</section><section class="level2"><h3 id="selecting-the-glyph-type">Selecting the glyph type<a class="anchor" aria-label="anchor" href="#selecting-the-glyph-type"></a>
</h3>
<p>The “kind of graphic” is specified by the name of the graphics function. All of the <code>ggformula</code> data graphics functions have names starting with <code>gf_</code>, which is intended to remind the user that they are formula-based interfaces to <code>ggplot2</code>: <code>g</code> for <code>ggplot2</code> and <code>f</code> for “formula.” Commonly used functions include</p>
<ul>
<li>
<code><a href="../reference/gf_point.html">gf_point()</a></code> for scatter plots</li>
<li>
<code><a href="../reference/gf_line.html">gf_line()</a></code> for line plots (connecting dots in a scatter plot)</li>
<li>
<code><a href="../reference/gf_density.html">gf_density()</a></code> or <code><a href="../reference/gf_density.html">gf_dens()</a></code> or <code><a href="../reference/gf_histogram.html">gf_histogram()</a></code> or <code><a href="../reference/gf_histogram.html">gf_dhistogram()</a></code> or <code><a href="../reference/gf_freqpoly.html">gf_freqpoly()</a></code> to display distributions of a quantitative variable</li>
<li>
<code><a href="../reference/gf_boxplot.html">gf_boxplot()</a></code> or <code><a href="../reference/gf_violin.html">gf_violin()</a></code> for comparing distributions side-by-side</li>
<li>
<code><a href="../reference/gf_bar.html">gf_counts()</a></code> for bar-graph style depictions of counts.</li>
<li>
<code><a href="../reference/gf_bar.html">gf_bar()</a></code> for more general bar-graph style graphics</li>
</ul>
<p>The function names generally match a corresponding function name from <code>ggplot2</code>, although</p>
<ul>
<li>
<code><a href="../reference/gf_bar.html">gf_counts()</a></code> is a simplified special case of <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar()</a></code>,</li>
<li>
<code><a href="../reference/gf_density.html">gf_dens()</a></code> is an alternative to <code><a href="../reference/gf_density.html">gf_density()</a></code> that displays the density plot slightly differently</li>
<li>
<code><a href="../reference/gf_histogram.html">gf_dhistogram()</a></code> produces a density histogram rather than a count histogram.</li>
</ul>
<p>Each of the <code>gf_</code> functions can create the coordinate axes and fill it in one operation. (In <code>ggplot2</code> nomenclature, <code>gf_</code> functions create a frame and add a layer, all in one operation.) This is what happens for the first <code>gf_</code> function in a chain. For subsequent <code>gf_</code> functions, new layers are added, each one “on top of” the previous layers.</p>
</section><section class="level2"><h3 id="attributes">Attributes<a class="anchor" aria-label="anchor" href="#attributes"></a>
</h3>
<p>Each of the marks in the plot is a <em>glyph</em>. Every glyph has graphical <em>attributes</em> (called aesthetics in <code>ggplot2</code>) that tell where and how to draw the glyph. In the above plot, the obvious attributes are x- and y-position:<br>
We’ve told R to put <code>mpg</code> along the y-axis and <code>hp</code> along the x-asis, as is clear from the plot.</p>
<p>But each point also has other attributes, including color, shape, size, stroke, fill, and alpha (transparency). We didn’t specify those in our example, so <code><a href="../reference/gf_point.html">gf_point()</a></code> uses some default values for those – in this case smallish black filled-in circles.</p>
<section class="level3"><h4 id="specifying-attributes">Specifying attributes<a class="anchor" aria-label="anchor" href="#specifying-attributes"></a>
</h4>
<p>In the <code>gf_</code> functions, you specify the non-position graphical attributes using additional arguments to the function. Attributes can be <strong>set</strong> to a constant value (e.g, set the color to “blue”; set the size to 2) or they can be <strong>mapped</strong> to a variable in the data or some expression involving the variables (e.g., map the color to <code>sex</code>, so sex determines the color groupings)</p>
<p>Attributes are set or mapped using additional arguments.</p>
<ul>
<li>adding an argument of the form <code>attribute = value</code> <strong>sets</strong> <code>attribute</code> to <code>value</code>.</li>
<li>adding an argument of the form <code>attribute = ~ expression</code> <strong>maps</strong> <code>attribute</code> to <code>expression</code>
</li>
</ul>
<p>where <code>attribute</code> is one of <code>color</code>, <code>shape</code>, etc., <code>value</code> is a constant (e.g. <code>"red"</code> or <code>0.5</code>, as appropriate), and <code>expression</code> may be some more general expression that can be computed using the variables in <code>data</code> (although often is is better to create a new variable in the data and to use that variable instead of an on-the-fly calculation within the plot).</p>
<p>The following plot, for instance,</p>
<ul>
<li><p>We use <code>cyl</code> to determine the color and <code>carb</code> to determine the size of each dot. Color and size are <strong>mapped</strong> to <code>cyl</code> and <code>carb</code>. A legend is provided to show us how the mapping is being done. (Later, we can use scales to control precisely how the mapping is done – which colors and sizes are used to represent which values of <code>cyl</code> and <code>carb</code>.)</p></li>
<li><p>We also <strong>set</strong> the transparency to 50%. The gives the same value of <code>alpha</code> to all glyphs in this layer.</p></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gf_point.html">gf_point</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">hp</span>, color <span class="op">=</span> <span class="op">~</span> <span class="va">cyl</span>, size <span class="op">=</span> <span class="op">~</span> <span class="va">carb</span>, alpha <span class="op">=</span> <span class="fl">0.50</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span> </span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/mapping-setting-1.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
</section><section class="level3"><h4 id="on-the-fly-calculations">On-the-fly calculations<a class="anchor" aria-label="anchor" href="#on-the-fly-calculations"></a>
</h4>
<p><code>ggformula</code> allows for on-the-fly calculations of attributes, although the default labeling of the plot is often better if we create a new variable in our data frame. In the examples below, since there are only three values for <code>carb</code>, it is easier to read the graph if we tell R to treat <code>cyl</code> as a categorical variable by converting to a factor (or to a string). Except for the labeling of the legend, these two plots are the same. In the second example, we see how the ggformula works well with data tranformations using <code>|&gt;</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/gf_point.html">gf_point</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">hp</span>,  color <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>, size <span class="op">=</span> <span class="op">~</span> <span class="va">carb</span>, alpha <span class="op">=</span> <span class="fl">0.75</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/on-the-fly-1.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cylinders <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_point.html">gf_point</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">hp</span>,  color <span class="op">=</span> <span class="op">~</span> <span class="va">cylinders</span>, size <span class="op">=</span> <span class="op">~</span> <span class="va">carb</span>, alpha <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/on-the-fly-2.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
</section></section><section class="level2"><h3 id="one-variable-plots">“One-variable” plots<a class="anchor" aria-label="anchor" href="#one-variable-plots"></a>
</h3>
<p>For some plots, we only have to specify the x-position because the y-position is calculated from the x-values. Histograms, densityplots, and frequency polygons are examples. To illustrate, we’ll use density plots, but the same ideas apply to <code><a href="../reference/gf_histogram.html">gf_histogram()</a></code>, and <code>gf_freqpolygon()</code> as well. <em>Note that in the one-variable density graphics, the variable whose density is to be calculated goes to the right of the tilde, in the position reserved for the x-axis variable.</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">penguins</span>, package <span class="op">=</span> <span class="st">"palmerpenguins"</span><span class="op">)</span>   </span>
<span><span class="fu"><a href="../reference/gf_density.html">gf_density</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">bill_length_mm</span>, data <span class="op">=</span> <span class="va">penguins</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/penguins-1.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gf_density.html">gf_density</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">bill_length_mm</span>,  fill <span class="op">=</span> <span class="op">~</span> <span class="va">species</span>,  alpha <span class="op">=</span> <span class="fl">0.5</span>, data <span class="op">=</span> <span class="va">penguins</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/penguins-2.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># gf_dens() is similar, but there is no line at bottom/sides and the plot is not fillable</span></span>
<span><span class="fu"><a href="../reference/gf_density.html">gf_dens</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">bill_length_mm</span>, color <span class="op">=</span> <span class="op">~</span> <span class="va">species</span>,  alpha <span class="op">=</span> <span class="fl">0.7</span>, data <span class="op">=</span> <span class="va">penguins</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/penguins-3.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># gf_dens2() is like gf_dens() but is fillable</span></span>
<span><span class="fu"><a href="../reference/gf_density.html">gf_dens2</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">bill_length_mm</span>, fill <span class="op">=</span> <span class="op">~</span> <span class="va">species</span>, data <span class="op">=</span> <span class="va">penguins</span>,</span>
<span>          color <span class="op">=</span> <span class="st">"gray50"</span>, alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> </span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/penguins-4.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>Several of the plotting functions include additional arguments that do not modify attributes of individual glyphs but control some other aspect of the plot. In this case, <code>adjust</code> can be used to increase or decrease the amount of smoothing.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># less smoothing</span></span>
<span><span class="va">penguins</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/gf_density.html">gf_dens</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">bill_length_mm</span>, color <span class="op">=</span> <span class="op">~</span> <span class="va">species</span>, alpha <span class="op">=</span> <span class="fl">0.7</span>, adjust <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span>  </span>
<span><span class="co">#&gt; Warning: Removed 2 rows containing non-finite outside the scale range</span></span>
<span><span class="co">#&gt; (`stat_density()`).</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/dens-1.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># more smoothing</span></span>
<span><span class="va">penguins</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/gf_density.html">gf_dens</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">bill_length_mm</span>, color <span class="op">=</span> <span class="op">~</span> <span class="va">species</span>, alpha <span class="op">=</span> <span class="fl">0.7</span>, adjust <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>     </span>
<span><span class="co">#&gt; Warning: Removed 2 rows containing non-finite outside the scale range</span></span>
<span><span class="co">#&gt; (`stat_density()`).</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/dens-2.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
</section><section class="level2"><h3 id="position">Position<a class="anchor" aria-label="anchor" href="#position"></a>
</h3>
<p>When the <code>fill</code> or <code>color</code> or <code>group</code> aesthetics are mapped to a variable, the default behavior is to lay the group-wise densities on top of one another. Other behavior is also available by using the <code>position</code> argument. Using the value <code>"stack"</code> causes the densities to be laid one on top of another. This makes the overall height of the stack represent the density across all groups, but it can be difficult to discern the shape of the distribution for the individual groups. The value <code>"fill"</code> produces a conditional probability graphic.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_density.html">gf_density</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">bill_length_mm</span>, fill <span class="op">=</span> <span class="op">~</span> <span class="va">species</span>, color <span class="op">=</span> <span class="cn">NA</span>, position <span class="op">=</span> <span class="st">"stack"</span><span class="op">)</span> </span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/position-1.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_density.html">gf_density</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">bill_length_mm</span>, fill <span class="op">=</span> <span class="op">~</span> <span class="va">species</span>, color <span class="op">=</span> <span class="cn">NA</span>, position <span class="op">=</span> <span class="st">"fill"</span>, </span>
<span>              adjust <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/position-2.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>Similar commands can be constructed with <code><a href="../reference/gf_histogram.html">gf_histogram()</a></code> and <code><a href="../reference/gf_freqpoly.html">gf_freqpoly()</a></code>, but note that <code>color</code>, not <code>fill</code>, is the active attribute for frequency polygons. It’s also rarely good to overlay histograms on top of one another – better to use a density plot or a frequency polygon for that application.</p>
</section><section class="level2"><h3 id="faceting">Faceting<a class="anchor" aria-label="anchor" href="#faceting"></a>
</h3>
<p>The <code>ggplot2</code> system allows you to make subplots — called “facets” — based on the values of one or two categorical variables. This is done by chaining with <code><a href="../reference/gf_facet_grid.html">gf_facet_grid()</a></code> or <code><a href="../reference/gf_facet_grid.html">gf_facet_wrap()</a></code>. These functions use formulas to specify which variable(s) are to be used for faceting.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_density_2d.html">gf_density_2d</a></span><span class="op">(</span><span class="va">bill_length_mm</span> <span class="op">~</span> <span class="va">bill_depth_mm</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_facet_grid.html">gf_facet_grid</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">species</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/facets-1.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># the dot here is a bit strange, but required to make a valid formula</span></span>
<span><span class="va">penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_density_2d.html">gf_density_2d</a></span><span class="op">(</span><span class="va">bill_length_mm</span> <span class="op">~</span> <span class="va">bill_depth_mm</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_facet_grid.html">gf_facet_grid</a></span><span class="op">(</span> <span class="va">species</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/facets-2.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_density_2d.html">gf_density_2d</a></span><span class="op">(</span><span class="va">bill_length_mm</span> <span class="op">~</span> <span class="va">bill_depth_mm</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_facet_grid.html">gf_facet_grid</a></span><span class="op">(</span><span class="va">island</span> <span class="op">~</span> <span class="va">species</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/facets-3.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_density_2d.html">gf_density_2d_filled</a></span><span class="op">(</span><span class="va">bill_length_mm</span> <span class="op">~</span> <span class="va">bill_depth_mm</span>, </span>
<span>                       show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_facet_grid.html">gf_facet_wrap</a></span><span class="op">(</span><span class="va">island</span> <span class="op">~</span> <span class="va">species</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/facets-4.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>An alternative syntax uses <code>|</code> to separate the faceting information from the main part of the formula.<br>
Here is another example using our weather data. The redundant use of the <code>y</code> and <code>color</code> attributes for temperature makes it easier to compare across facets.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Weather</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_ribbon.html">gf_ribbon</a></span><span class="op">(</span><span class="va">low_temp</span> <span class="op">+</span> <span class="va">high_temp</span> <span class="op">~</span> <span class="va">date</span> <span class="op">|</span> <span class="va">city</span> <span class="op">~</span> <span class="va">year</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> </span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/facets02-1.png" class="quarto-figure quarto-figure-center" style="width:95.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">Weather</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_linerange.html">gf_linerange</a></span><span class="op">(</span><span class="va">low_temp</span> <span class="op">+</span> <span class="va">high_temp</span> <span class="op">~</span> <span class="va">date</span> <span class="op">|</span> <span class="va">city</span> <span class="op">~</span> <span class="va">year</span>, color <span class="op">=</span> <span class="op">~</span> <span class="va">avg_temp</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gf_aux.html">gf_refine</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_colour_gradientn</a></span><span class="op">(</span>colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">rainbow</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/facets02-2.png" class="quarto-figure quarto-figure-center" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
<p>In this case, we should either not facet by year, or allows the x-scale to be freely adjusted in each column so that we don’t have so much unnecessary white space. We can do the latter using the <code>scales</code> argument to <code><a href="../reference/gf_facet_grid.html">gf_facet_grid()</a></code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Weather</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_ribbon.html">gf_ribbon</a></span><span class="op">(</span><span class="va">low_temp</span> <span class="op">+</span> <span class="va">high_temp</span> <span class="op">~</span> <span class="va">date</span> <span class="op">|</span> <span class="va">city</span> <span class="op">~</span> <span class="va">.</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> </span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/facets03-1.png" class="quarto-figure quarto-figure-center" style="width:95.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">Weather</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_linerange.html">gf_linerange</a></span><span class="op">(</span><span class="va">low_temp</span> <span class="op">+</span> <span class="va">high_temp</span> <span class="op">~</span> <span class="va">date</span>, color <span class="op">=</span> <span class="op">~</span> <span class="va">avg_temp</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gf_aux.html">gf_refine</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_colour_gradientn</a></span><span class="op">(</span>colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">rainbow</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gf_facet_grid.html">gf_facet_grid</a></span><span class="op">(</span><span class="va">city</span> <span class="op">~</span> <span class="va">year</span>, scales <span class="op">=</span> <span class="st">"free_x"</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/facets03-2.png" class="quarto-figure quarto-figure-center" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
</section><section class="level2"><h3 id="labels-in-plots">Labels in plots<a class="anchor" aria-label="anchor" href="#labels-in-plots"></a>
</h3>
<p>Usually plot labels reflect the expression mapped to a given attribute. But in the previous example, our colorbar legend is labeled “avg temp (F)” even though the variable name is <code>avg_temp</code>. This is because the <code>Weather</code> data set is <em>labeled</em>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/labels.html">get_variable_labels</a></span><span class="op">(</span><span class="va">Weather</span><span class="op">)</span></span>
<span><span class="co">#&gt; $city</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $date</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $year</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $month</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $day</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $high_temp</span></span>
<span><span class="co">#&gt; [1] "high temp (F)"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $avg_temp</span></span>
<span><span class="co">#&gt; [1] "avg temp (F)"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $low_temp</span></span>
<span><span class="co">#&gt; [1] "low temp (F)"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $high_dewpt</span></span>
<span><span class="co">#&gt; [1] "high dew point (F)"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $avg_dewpt</span></span>
<span><span class="co">#&gt; [1] "avg dew point (F)"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $low_dewpt</span></span>
<span><span class="co">#&gt; [1] "low dew point (F)"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $high_humidity</span></span>
<span><span class="co">#&gt; [1] "high relative humidity"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $avg_humidity</span></span>
<span><span class="co">#&gt; [1] "avg relative humidity"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $low_humidity</span></span>
<span><span class="co">#&gt; [1] "low relative humidity"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $high_hg</span></span>
<span><span class="co">#&gt; [1] "high pressure (mm Hg)"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $avg_hg</span></span>
<span><span class="co">#&gt; [1] "avg pressure (mm Hg)"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $low_hg</span></span>
<span><span class="co">#&gt; [1] "low pressure (mm Hg)"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $high_vis</span></span>
<span><span class="co">#&gt; [1] "high visibility (miles)"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $avg_vis</span></span>
<span><span class="co">#&gt; [1] "avg visibility (miles)"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $low_vis</span></span>
<span><span class="co">#&gt; [1] "low visibility (miles)"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $high_wind</span></span>
<span><span class="co">#&gt; [1] "high wind speed (mph)"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $avg_wind</span></span>
<span><span class="co">#&gt; [1] "avg wind speed (mph)"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $low_wind</span></span>
<span><span class="co">#&gt; [1] "low wind speed (mph)"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $precip</span></span>
<span><span class="co">#&gt; [1] "precipitation"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $events</span></span>
<span><span class="co">#&gt; [1] "events"</span></span></code></pre></div>
</div>
<p>ggformula will detect these labels and use them on our plots. We can use <code><a href="https://larmarange.github.io/labelled/reference/var_label.html" class="external-link">set_variable_labels()</a></code> to add custom labels to some or all of the variables in a data frame.<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;labels&lt;/p&gt;"><sup>1</sup></a></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">KF</span> <span class="op">&lt;-</span> <span class="va">KidsFeet</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://larmarange.github.io/labelled/reference/var_label.html" class="external-link">set_variable_labels</a></span><span class="op">(</span></span>
<span>    length <span class="op">=</span> <span class="st">"length (cm)"</span>, </span>
<span>    width <span class="op">=</span> <span class="st">"width (cm)"</span>,</span>
<span>    domhand <span class="op">=</span> <span class="st">"dominant hand"</span>,</span>
<span>    biggerfoot <span class="op">=</span> <span class="st">"bigger foot"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">KidsFeet</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_point.html">gf_point</a></span><span class="op">(</span><span class="va">width</span> <span class="op">~</span> <span class="va">length</span>, color <span class="op">=</span> <span class="op">~</span><span class="va">domhand</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/unnamed-chunk-3-1.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">KF</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gf_point.html">gf_point</a></span><span class="op">(</span><span class="va">width</span> <span class="op">~</span> <span class="va">length</span>, color <span class="op">=</span> <span class="op">~</span><span class="va">domhand</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/unnamed-chunk-3-2.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">Penguins</span> <span class="op">&lt;-</span> <span class="va">penguins</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://larmarange.github.io/labelled/reference/var_label.html" class="external-link">set_variable_labels</a></span><span class="op">(</span></span>
<span>    species <span class="op">=</span> <span class="st">"Species"</span>,</span>
<span>    island <span class="op">=</span> <span class="st">"Island"</span>,</span>
<span>    bill_length_mm <span class="op">=</span> <span class="st">"Bill Length (mm)"</span>,</span>
<span>    bill_depth_mm <span class="op">=</span> <span class="st">"Bill Depth (mm)"</span>,</span>
<span>    flipper_length_mm <span class="op">=</span> <span class="st">"Flipper Length (mm)"</span>,</span>
<span>    body_mass_g <span class="op">=</span> <span class="st">"Body Mass (g)"</span>,</span>
<span>    sex <span class="op">=</span> <span class="st">"Sex"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">Penguins</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gf_point.html">gf_point</a></span><span class="op">(</span><span class="va">bill_length_mm</span> <span class="op">~</span> <span class="va">bill_depth_mm</span>, color <span class="op">=</span> <span class="op">~</span> <span class="va">species</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Warning: Removed 2 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/unnamed-chunk-3-3.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>By adding labels to the data, we can ensure consitent labeling across several plots. But it is also possible to modify labels just for one plot. This can be done in three ways:</p>
<ul>
<li>We can use arguments like <code>xlab</code>, <code>ylab</code>, and <code>title</code>;</li>
<li>We can use the <code><a href="../reference/gf_aux.html">gf_labs()</a></code> function (which has arguments like <code>x</code>, <code>y</code>, <code>title</code>, etc.);</li>
<li>We can use the <code><a href="../reference/gf_relabel.html">gf_relabel()</a></code> function.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">KidsFeet</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gf_point.html">gf_point</a></span><span class="op">(</span><span class="va">width</span> <span class="op">~</span> <span class="va">length</span>, color <span class="op">=</span> <span class="op">~</span><span class="va">domhand</span>, xlab <span class="op">=</span> <span class="st">"length (cm)"</span>, </span>
<span>           title <span class="op">=</span> <span class="st">"Length and width of kids' feet"</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/unnamed-chunk-4-1.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">KidsFeet</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/gf_point.html">gf_point</a></span><span class="op">(</span><span class="va">width</span> <span class="op">~</span> <span class="va">length</span>, color <span class="op">=</span> <span class="op">~</span><span class="va">domhand</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_aux.html">gf_labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"length (cm)"</span>, color <span class="op">=</span> <span class="st">"dominant hand"</span>, title <span class="op">=</span> <span class="st">"Some kids' feet"</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/unnamed-chunk-4-2.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">p</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_relabel.html">gf_relabel</a></span><span class="op">(</span>length <span class="op">=</span> <span class="st">"length (cm)"</span>, width <span class="op">=</span> <span class="st">"width (cm)"</span>, domhand <span class="op">=</span> <span class="st">"dominant hand"</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/unnamed-chunk-4-3.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># alternatively, we can use a list. </span></span>
<span><span class="co"># this is handy if we have several data sets with the same variables.</span></span>
<span><span class="va">KFlabels</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>length <span class="op">=</span> <span class="st">"length (cm)"</span>, width <span class="op">=</span> <span class="st">"width (cm)"</span>, domhand <span class="op">=</span> <span class="st">"dominant hand"</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_relabel.html">gf_relabel</a></span><span class="op">(</span><span class="va">KFlabels</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/unnamed-chunk-4-4.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>Notice that <code><a href="../reference/gf_aux.html">gf_labs()</a></code> and <code><a href="../reference/gf_relabel.html">gf_relabel()</a></code> take a different approaches to labeling. <code><a href="../reference/gf_aux.html">gf_labs()</a></code> refers to labels by their <em>role in the plot</em> whereas <code><a href="../reference/gf_relabel.html">gf_relabel()</a></code> refers to variables in the data set and uses the new labels wherever the variable appears. Both are useful. <code><a href="../reference/gf_aux.html">gf_labs()</a></code> provides access to additional labels (title, subtitle, caption, etc.), but it easier to mistakenly create a plot with a label that doesn’t match the true content of the plot. <code><a href="../reference/gf_relabel.html">gf_relabel()</a></code> only deals with labels associated with variables, but the label is guaranteed to match that variable no matter how the variable is used within the plot.</p>
</section><section class="level2"><h3 id="chaining-to-create-complex-plots">Chaining to create complex plots<a class="anchor" aria-label="anchor" href="#chaining-to-create-complex-plots"></a>
</h3>
<p>Often it is useful to overlay multiple layers onto a single plot. This can be done by chaining them with <code>|&gt;</code>, the “then” operator from <code>magrittr</code>. The <code>data</code> argument can be omitted if the new layers uses the same data as the first layer in the chain.</p>
<p>The following plot illustrates how histograms and frequency polygons are related.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_histogram.html">gf_histogram</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">bill_length_mm</span>, alpha <span class="op">=</span> <span class="fl">0.3</span>, fill <span class="op">=</span> <span class="st">"navy"</span>, binwidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gf_freqpoly.html">gf_freqpoly</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">bill_length_mm</span> , binwidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_facet_grid.html">gf_facet_grid</a></span><span class="op">(</span><span class="va">species</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 2 rows containing non-finite outside the scale range (`stat_bin()`).</span></span>
<span><span class="co">#&gt; Removed 2 rows containing non-finite outside the scale range (`stat_bin()`).</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/layers-1.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>A 2-d density plot can be augmented with a scatterplot.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_density_2d.html">gf_density_2d</a></span><span class="op">(</span><span class="va">bill_length_mm</span> <span class="op">~</span> <span class="va">bill_depth_mm</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gf_jitter.html">gf_jitter</a></span><span class="op">(</span><span class="va">bill_length_mm</span> <span class="op">~</span> <span class="va">bill_depth_mm</span>, alpha <span class="op">=</span> <span class="fl">0.2</span>, width <span class="op">=</span> <span class="fl">0.2</span>, height <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gf_facet_grid.html">gf_facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">species</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 2 rows containing non-finite outside the scale range</span></span>
<span><span class="co">#&gt; (`stat_density2d()`).</span></span>
<span><span class="co">#&gt; Warning: Removed 2 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/layers02-1.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
</section><section class="level2"><h3 id="more-2-variable-plots">More 2-variable plots<a class="anchor" aria-label="anchor" href="#more-2-variable-plots"></a>
</h3>
<section class="level3"><h4 id="using-jitter-and-transparency-to-handle-overlapping-cases">Using jitter and transparency to handle overlapping cases<a class="anchor" aria-label="anchor" href="#using-jitter-and-transparency-to-handle-overlapping-cases"></a>
</h4>
<p>Sometimes you have so many points in a scatter plot that they obscure one another. The <code>ggplot2</code> system provides two easy ways to deal with this: translucency and jittering. Use <code>alpha</code> to make the points semi-translucent.</p>
<p>Using <code><a href="../reference/gf_jitter.html">gf_jitter()</a></code> in place of <code><a href="../reference/gf_point.html">gf_point()</a></code> will move the plotted points to reduce overlap. Jitter and transparency can be used together as well.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_point.html">gf_point</a></span><span class="op">(</span><span class="va">bill_length_mm</span> <span class="op">~</span> <span class="va">species</span>, alpha <span class="op">=</span> <span class="fl">0.15</span><span class="op">)</span>  </span>
<span><span class="co">#&gt; Warning: Removed 2 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/jitter-1.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Penguins</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gf_jitter.html">gf_jitter</a></span><span class="op">(</span><span class="va">bill_length_mm</span> <span class="op">~</span> <span class="va">species</span>, alpha <span class="op">=</span> <span class="fl">0.35</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 2 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/jitter-2.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># width and heigh control the amount of horizontal and vertical jitter</span></span>
<span><span class="va">Penguins</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gf_jitter.html">gf_jitter</a></span><span class="op">(</span><span class="va">bill_length_mm</span> <span class="op">~</span> <span class="va">species</span>, alpha <span class="op">=</span> <span class="fl">0.35</span>, width <span class="op">=</span> <span class="fl">0.2</span>, height <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 2 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/jitter-3.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
</section><section class="level3"><h4 id="box-and-whisker-plots">Box and Whisker plots<a class="anchor" aria-label="anchor" href="#box-and-whisker-plots"></a>
</h4>
<p>Box and whisker plots show the distribution of a quantitative variable as a function of a categorical variable. The formula used in <code><a href="../reference/gf_boxplot.html">gf_boxplot()</a></code> should have the quantitative variable to the left of the tilde. (To make horizontal boxplots using <code>ggplot2</code> you have to make vertical boxplots and then flip the coordinates with <code><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip()</a></code>.)</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gf_boxplot.html">gf_boxplot</a></span><span class="op">(</span><span class="va">length</span> <span class="op">~</span> <span class="va">sex</span>, color <span class="op">=</span> <span class="st">"red"</span>, data <span class="op">=</span> <span class="va">KF</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/boxplot-1.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gf_boxplot.html">gf_boxplot</a></span><span class="op">(</span><span class="va">length</span> <span class="op">~</span> <span class="va">sex</span>, color <span class="op">=</span> <span class="op">~</span><span class="va">biggerfoot</span> , data <span class="op">=</span> <span class="va">KF</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/boxplot-2.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>This plot may surprise you.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Weather</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_boxplot.html">gf_boxplot</a></span><span class="op">(</span><span class="va">high_temp</span> <span class="op">~</span> <span class="va">month</span> <span class="op">|</span> <span class="va">city</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Continuous x aesthetic</span></span>
<span><span class="co">#&gt; ℹ did you forget `aes(group = ...)`?</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/boxplot02-1.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>A single plot is placed at the at the mean value of <code>month</code> (for each city). The warning message suggests that we need to tell R how to form the groups when using a quantitative variable for <code>x</code>. It suggests using the <code>group</code> aesthetic, and sometimes, this is just what we want.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Weather</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gf_boxplot.html">gf_boxplot</a></span><span class="op">(</span><span class="va">high_temp</span> <span class="op">~</span> <span class="va">month</span> <span class="op">|</span>  <span class="va">city</span>, group <span class="op">=</span> <span class="op">~</span> <span class="va">month</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/boxplot03-1.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>Alternatively, we could create a new categorical variable that puts the quantitative values into one of a few different bins.</p>
</section><section class="level3"><h4 id="alternatives-to-box-and-whisker-plots-">Alternatives to box and whisker plots.<a class="anchor" aria-label="anchor" href="#alternatives-to-box-and-whisker-plots-"></a>
</h4>
<p><code><a href="../reference/gf_violin.html">gf_violin()</a></code> and <code><a href="../reference/gf_sina.html">gf_sina()</a></code> provide two alternatives to box and whisker plots.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Penguins</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/gf_violin.html">gf_violin</a></span><span class="op">(</span><span class="va">bill_length_mm</span> <span class="op">~</span>  <span class="va">species</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 2 rows containing non-finite outside the scale range</span></span>
<span><span class="co">#&gt; (`stat_ydensity()`).</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/violin-sina-1.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://ggforce.data-imaginist.com" class="external-link">ggforce</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">Penguins</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/gf_sina.html">gf_sina</a></span><span class="op">(</span><span class="va">bill_length_mm</span> <span class="op">~</span>  <span class="va">species</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span>  <span class="va">Penguins</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../reference/gf_violin.html">gf_violin</a></span><span class="op">(</span><span class="va">bill_length_mm</span> <span class="op">~</span>  <span class="va">species</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../reference/gf_sina.html">gf_sina</a></span><span class="op">(</span><span class="va">bill_length_mm</span> <span class="op">~</span>  <span class="va">species</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, color <span class="op">=</span> <span class="op">~</span> <span class="va">island</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Loading required package: ggforce</span></span>
<span><span class="co">#&gt; Warning: Removed 2 rows containing non-finite outside the scale range</span></span>
<span><span class="co">#&gt; (`stat_ydensity()`).</span></span>
<span><span class="co">#&gt; Warning: Removed 2 rows containing non-finite outside the scale range</span></span>
<span><span class="co">#&gt; (`stat_sina()`).</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/violin-sina-2.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
</section><section class="level3"><h4 id="ridge-plots">Ridge plots<a class="anchor" aria-label="anchor" href="#ridge-plots"></a>
</h4>
<p>Ridge plots can be useful to displaying multiple density plots compactly.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Weather</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ggridges.html">gf_density_ridges</a></span><span class="op">(</span><span class="va">month</span> <span class="op">~</span> <span class="va">high_temp</span> <span class="op">|</span> <span class="va">city</span>, group <span class="op">=</span> <span class="op">~</span><span class="va">month</span><span class="op">)</span></span>
<span><span class="co">#&gt; Picking joint bandwidth of 1.09</span></span>
<span><span class="co">#&gt; Picking joint bandwidth of 2.45</span></span>
<span><span class="co">#&gt; Picking joint bandwidth of 3.79</span></span>
<span><span class="co">#&gt; Picking joint bandwidth of 1.16</span></span>
<span><span class="co">#&gt; Picking joint bandwidth of 1.7</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/ridge-plots-1.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Weather</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ggridges.html">gf_density_ridges_gradient</a></span><span class="op">(</span><span class="va">month</span> <span class="op">~</span> <span class="va">high_temp</span> <span class="op">|</span> <span class="va">city</span>, group <span class="op">=</span> <span class="op">~</span> <span class="va">month</span>, </span>
<span>                             show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_aux.html">gf_refine</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"B"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: `stat(x)` was deprecated in ggplot2 3.4.0.</span></span>
<span><span class="co">#&gt; ℹ Please use `after_stat(x)` instead.</span></span>
<span><span class="co">#&gt; Picking joint bandwidth of 1.09</span></span>
<span><span class="co">#&gt; Picking joint bandwidth of 2.45</span></span>
<span><span class="co">#&gt; Picking joint bandwidth of 3.79</span></span>
<span><span class="co">#&gt; Picking joint bandwidth of 1.16</span></span>
<span><span class="co">#&gt; Picking joint bandwidth of 1.7</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/ridge-plots-2.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
</section><section class="level3"><h4 id="dimensional-density-plots">2-dimensional density plots<a class="anchor" aria-label="anchor" href="#dimensional-density-plots"></a>
</h4>
<p>Two-dimensional plots of density also have both a left and right component to the formula.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Penguins</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/gf_density_2d.html">gf_density_2d</a></span><span class="op">(</span><span class="va">bill_length_mm</span> <span class="op">~</span> <span class="va">bill_depth_mm</span> <span class="op">|</span> <span class="va">species</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 2 rows containing non-finite outside the scale range</span></span>
<span><span class="co">#&gt; (`stat_density2d()`).</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/density2d-hex-1.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Penguins</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/gf_density_2d.html">gf_density_2d_filled</a></span><span class="op">(</span><span class="va">bill_length_mm</span> <span class="op">~</span> <span class="va">bill_depth_mm</span> <span class="op">|</span> <span class="va">species</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 2 rows containing non-finite outside the scale range</span></span>
<span><span class="co">#&gt; (`stat_density2d_filled()`).</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/density2d-hex-2.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Penguins</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/gf_hex.html">gf_hex</a></span><span class="op">(</span><span class="va">bill_length_mm</span> <span class="op">~</span> <span class="va">bill_depth_mm</span> <span class="op">|</span> <span class="va">species</span>, binwidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 2 rows containing non-finite outside the scale range</span></span>
<span><span class="co">#&gt; (`stat_binhex()`).</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/density2d-hex-3.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
</section><section class="level3"><h4 id="paths-and-lines">Paths and lines<a class="anchor" aria-label="anchor" href="#paths-and-lines"></a>
</h4>
<p>The <code>ggplot2</code> system offers two ways to connect points. <code><a href="../reference/gf_line.html">gf_line()</a></code> ignores the order of the points in the data, and draws the line going from left to right. <code><a href="../reference/gf_line.html">gf_path()</a></code> goes from point to point according to the order in the data. Both forms can use a <code>color</code> or <code>group</code> aesthetic to indicate which groups of points are connected.</p>
<!-- The above are examples of *bad plots*. The viewer is unnecessarily distracted by -->
<!-- the zigs and zags in the connecting lines. It would be better to use -->
<!-- `gf_point()` here, but then you wouldn't see how `gf_line()` and `gf_path()` -->
<!-- work! -->
<p>Here’s an example where <code><a href="../reference/gf_line.html">gf_line()</a></code> is useful. We begin with a scatter plot showing the number of live births in the US for each day of 1978.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Births78</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/gf_point.html">gf_point</a></span><span class="op">(</span><span class="va">births</span> <span class="op">~</span> <span class="va">date</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/births01-1.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>Can this interesting pattern be explained by a weekday/weekend effect?<br>
Converting to a line plot and coloring by day of week highlights the pattern and makes it easy to spot the unusual days.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Births78</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/gf_line.html">gf_line</a></span><span class="op">(</span><span class="va">births</span> <span class="op">~</span> <span class="va">date</span>, color <span class="op">=</span> <span class="op">~</span> <span class="va">wday</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/births03-1.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>The example above would look the same if we used <code><a href="../reference/gf_line.html">gf_path()</a></code> because the data set is already sorted by date. But in general, <code><a href="../reference/gf_line.html">gf_path()</a></code> and <code><a href="../reference/gf_line.html">gf_line()</a></code> produce different results. In the plots below, the first connects days chronologically (because the data are sorted by date) and the second in order of their low temperature.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Weather</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">month</span> <span class="op">==</span> <span class="fl">5</span>, <span class="va">year</span> <span class="op">==</span> <span class="fl">2017</span>, <span class="va">city</span> <span class="op">==</span> <span class="st">"Chicago"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gf_line.html">gf_path</a></span><span class="op">(</span><span class="va">high_temp</span> <span class="op">~</span> <span class="va">low_temp</span> <span class="op">|</span> <span class="va">city</span> <span class="op">~</span> <span class="va">year</span>, color <span class="op">=</span> <span class="op">~</span> <span class="va">day</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gf_aux.html">gf_refine</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_c</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"C"</span>, begin <span class="op">=</span> <span class="fl">0.2</span>, end <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/paths-1.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Weather</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">month</span> <span class="op">==</span> <span class="fl">5</span>, <span class="va">year</span> <span class="op">==</span> <span class="fl">2017</span>, <span class="va">city</span> <span class="op">==</span> <span class="st">"Chicago"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gf_line.html">gf_line</a></span><span class="op">(</span><span class="va">high_temp</span> <span class="op">~</span> <span class="va">low_temp</span> <span class="op">|</span> <span class="va">city</span> <span class="op">~</span> <span class="va">year</span>, color <span class="op">=</span> <span class="op">~</span> <span class="va">day</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gf_aux.html">gf_refine</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_c</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"C"</span>, begin <span class="op">=</span> <span class="fl">0.2</span>, end <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/paths-2.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
</section></section><section class="level2"><h3 id="plots-with-more-than-2-positional-attributes">Plots with more than 2 positional attributes<a class="anchor" aria-label="anchor" href="#plots-with-more-than-2-positional-attributes"></a>
</h3>
<p>Some layers require more than two attributes. Typically this happens when the glyphs of a layer are complex objects that could have been made using multiple layers, but belong together conceptually. Examples include</p>
<ul>
<li>
<code><a href="../reference/gf_linerange.html">gf_pointrange()</a></code> – plots a dot flanked by a line segment.<br>
</li>
<li>
<code>gf_linrange()</code> – like <code><a href="../reference/gf_linerange.html">gf_pointrange()</a></code> but without the point.</li>
<li>
<code><a href="../reference/gf_errorbar.html">gf_errorbar()</a></code> – vertical error bars.</li>
<li>
<code><a href="../reference/ggstance.html">gf_errorbarh()</a></code> – horizontal error bars.</li>
<li>
<code><a href="../reference/gf_ribbon.html">gf_ribbon()</a></code> – a band between a line above and line below.</li>
</ul>
<p>Often these are used to depict some sort of estimate of uncertainty in a measurement or a prediction, but they can be used to represent any data of the correct form. Here we will use <code><a href="../reference/gf_linerange.html">gf_linerange()</a></code> and <code><a href="../reference/gf_ribbon.html">gf_ribbon()</a></code> to indicate the high and low temperatures in New York for the first few months of 2013.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Temps</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">Weather</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">month</span> <span class="op">&lt;=</span> <span class="fl">4</span>, <span class="va">year</span> <span class="op">&lt;=</span> <span class="fl">2016</span>, <span class="va">city</span> <span class="op">==</span> <span class="st">"Chicago"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Temps</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_linerange.html">gf_pointrange</a></span><span class="op">(</span><span class="va">avg_temp</span> <span class="op">+</span> <span class="va">low_temp</span> <span class="op">+</span> <span class="va">high_temp</span>  <span class="op">~</span> <span class="va">date</span>, color <span class="op">=</span> <span class="op">~</span> <span class="va">avg_temp</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_aux.html">gf_refine</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_color_gradientn</a></span><span class="op">(</span>colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"green"</span>, <span class="st">"orange"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/weather-1.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">Temps</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_ribbon.html">gf_ribbon</a></span><span class="op">(</span><span class="va">low_temp</span> <span class="op">+</span> <span class="va">high_temp</span>  <span class="op">~</span> <span class="va">date</span>, color <span class="op">=</span> <span class="st">"navy"</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/weather-2.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
</section><section class="level2"><h3 id="positions-and-stats">Positions and Stats<a class="anchor" aria-label="anchor" href="#positions-and-stats"></a>
</h3>
<section class="level3"><h4 id="positions">Positions<a class="anchor" aria-label="anchor" href="#positions"></a>
</h4>
<p><code><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge()</a></code>, <code><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter()</a></code>, and <code><a href="https://ggplot2.tidyverse.org/reference/position_jitterdodge.html" class="external-link">position_jitterdodge()</a></code> can be used to adjust the positions at which glyphs are placed. Jittering adds some random noise and can be useful when many observations have the same value. Dodging moves groups of glyphs a fixed difference to make it easier to distinguish the groups.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">KidsFeet</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_point.html">gf_point</a></span><span class="op">(</span><span class="va">length</span> <span class="op">~</span> <span class="va">sex</span>, color <span class="op">=</span> <span class="op">~</span> <span class="va">domhand</span>, </span>
<span>           position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitterdodge.html" class="external-link">position_jitterdodge</a></span><span class="op">(</span>jitter.width <span class="op">=</span> <span class="fl">0.2</span>, dodge.width <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/KidsFeet-1.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
</section><section class="level3"><h4 id="stats">Stats<a class="anchor" aria-label="anchor" href="#stats"></a>
</h4>
<p>A <strong>stat</strong> is a transformation that is applied to the data before a plot is generated. Several of the plots we have seen have made use of stats.</p>
<ul>
<li>
<code><a href="../reference/gf_histogram.html">gf_histogram()</a></code> uses <code><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">stat_bin()</a></code> to bin the data and count the number of observations in each bin. It is equivalent to</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">HELPrct</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/gf_bar.html">gf_bar</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">age</span>, stat <span class="op">=</span> <span class="st">"bin"</span><span class="op">)</span></span>
<span><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value `binwidth`.</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/stats-1.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p><code><a href="../reference/gf_boxplot.html">gf_boxplot()</a></code> uses <code><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">stat_boxplot()</a></code> to compute the five-number summary on which the boxplot is based.</p></li>
<li><p><code><a href="../reference/gf_violin.html">gf_violin()</a></code>, <code><a href="../reference/gf_density.html">gf_density()</a></code>, and <code><a href="../reference/gf_density_2d.html">gf_density2d()</a></code> use stats to compute a sequence of points along an estimated density. It is these points, and the not the raw data that are used to create the plot. <code><a href="../reference/gf_sina.html">gf_sina()</a></code> uses the estimated density to jitter points.</p></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gf_boxplot.html">gf_boxplot</a></span><span class="op">(</span><span class="va">age</span> <span class="op">~</span> <span class="va">substance</span>, data <span class="op">=</span> <span class="va">HELPrct</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/boxplot-violin-sina-1.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gf_violin.html">gf_violin</a></span><span class="op">(</span><span class="va">age</span> <span class="op">~</span> <span class="va">substance</span>, data <span class="op">=</span> <span class="va">HELPrct</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gf_sina.html">gf_sina</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/boxplot-violin-sina-2.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>There are also a number of stats that can be used to show a functional relationship between two variables.</p>
<ul>
<li><p><code><a href="../reference/gf_smooth.html">gf_smooth()</a></code> plots a model fit using <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>, <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm()</a></code>, <code>gam()</code>, <code><a href="https://rdrr.io/r/stats/loess.html" class="external-link">loess()</a></code>, <code><a href="https://rdrr.io/pkg/MASS/man/rlm.html" class="external-link">MASS::rlm()</a></code>.</p></li>
<li><p><code><a href="../reference/gf_smooth.html">gf_lm()</a></code> is <code><a href="../reference/gf_smooth.html">gf_smooth()</a></code> with the method set to <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> so it plots a least squares regression line.</p></li>
<li><p><code><a href="../reference/gf_spline.html">gf_spline()</a></code> plots a spline fit to the data.</p></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">KidsFeet</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_point.html">gf_point</a></span><span class="op">(</span><span class="va">length</span> <span class="op">~</span> <span class="va">width</span>, color <span class="op">=</span> <span class="op">~</span> <span class="va">sex</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gf_smooth.html">gf_lm</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/unnamed-chunk-5-1.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu">mosaicData</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/mosaicData/man/Births.html" class="external-link">Births</a></span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu"><a href="../reference/gf_point.html">gf_point</a></span><span class="op">(</span><span class="va">births</span> <span class="op">~</span> <span class="va">date</span>, color <span class="op">=</span> <span class="op">~</span><span class="va">wday</span>, alpha <span class="op">=</span> <span class="fl">0.15</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gf_smooth.html">gf_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"loess"</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/unnamed-chunk-5-2.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu">mosaicData</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/mosaicData/man/Births.html" class="external-link">Births</a></span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu"><a href="../reference/gf_point.html">gf_point</a></span><span class="op">(</span><span class="va">births</span> <span class="op">~</span> <span class="va">date</span>, color <span class="op">=</span> <span class="op">~</span><span class="va">wday</span>, alpha <span class="op">=</span> <span class="fl">0.15</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gf_spline.html">gf_spline</a></span><span class="op">(</span>spar <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/unnamed-chunk-5-3.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>Confidence or prediction bands can be added to these as well.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">KidsFeet</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_point.html">gf_point</a></span><span class="op">(</span><span class="va">length</span> <span class="op">~</span> <span class="va">width</span> <span class="op">|</span> <span class="va">sex</span>, color <span class="op">=</span> <span class="op">~</span> <span class="va">sex</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gf_smooth.html">gf_lm</a></span><span class="op">(</span>interval <span class="op">=</span> <span class="st">"prediction"</span>, fill <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gf_smooth.html">gf_lm</a></span><span class="op">(</span>interval <span class="op">=</span> <span class="st">"confidence"</span>, fill <span class="op">=</span> <span class="st">"navy"</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/unnamed-chunk-6-1.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>Mostly, the stats selected by default are just the ones you need. But sometimes it is useful to select a different stat. The <code><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html" class="external-link">stat_summary()</a></code> and <code><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html" class="external-link">stat_summary_bin()</a></code> stats are particularly useful in this respect. These stats use a function to aggregate over unique values of <code>x</code> or over bins of <code>x</code> values and save the user needing to do that data transformation manually.</p>
<p>The default function applied in each group is <code><a href="https://ggplot2.tidyverse.org/reference/mean_se.html" class="external-link">mean_se()</a></code>, which computes the mean (and the mean plus and minus one standard error) This makes it simple to create an “interaction plot”.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">KidsFeet</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_jitter.html">gf_jitter</a></span><span class="op">(</span><span class="va">length</span> <span class="op">~</span> <span class="va">sex</span>, color <span class="op">=</span> <span class="op">~</span> <span class="va">domhand</span>, width <span class="op">=</span> <span class="fl">0.1</span>, height <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gf_line.html">gf_line</a></span><span class="op">(</span><span class="va">length</span> <span class="op">~</span> <span class="va">sex</span>, color <span class="op">=</span> <span class="op">~</span> <span class="va">domhand</span>, group <span class="op">=</span> <span class="op">~</span> <span class="va">domhand</span>, stat <span class="op">=</span> <span class="st">"summary"</span><span class="op">)</span></span>
<span><span class="co">#&gt; No summary function supplied, defaulting to `mean_se()`</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/stats02-1.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_jitter.html">gf_jitter</a></span><span class="op">(</span><span class="va">body_mass_g</span> <span class="op">~</span> <span class="va">sex</span>, color <span class="op">=</span> <span class="op">~</span> <span class="va">species</span>, width <span class="op">=</span> <span class="fl">0.1</span>, height <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gf_line.html">gf_line</a></span><span class="op">(</span><span class="va">body_mass_g</span> <span class="op">~</span> <span class="va">sex</span>, color <span class="op">=</span> <span class="op">~</span> <span class="va">species</span>, group <span class="op">=</span> <span class="op">~</span> <span class="va">species</span>, stat <span class="op">=</span> <span class="st">"summary"</span><span class="op">)</span></span>
<span><span class="co">#&gt; No summary function supplied, defaulting to `mean_se()`</span></span>
<span><span class="co">#&gt; Warning: Removed 2 rows containing non-finite outside the scale range</span></span>
<span><span class="co">#&gt; (`stat_summary()`).</span></span>
<span><span class="co">#&gt; Warning: Removed 2 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/stats02-2.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>The other two values computed by <code><a href="https://ggplot2.tidyverse.org/reference/mean_se.html" class="external-link">mean_se()</a></code> are available (starting with <code>ggplot2</code> version 2.3) as <code>stat(ymin)</code> and <code>stat(ymax)</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">KidsFeet</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_jitter.html">gf_jitter</a></span><span class="op">(</span><span class="va">length</span> <span class="op">~</span> <span class="va">sex</span>, color <span class="op">=</span> <span class="op">~</span> <span class="va">domhand</span>, width <span class="op">=</span> <span class="fl">0.1</span>, height <span class="op">=</span> <span class="fl">0</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gf_linerange.html">gf_pointrange</a></span><span class="op">(</span><span class="va">length</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">stat</a></span><span class="op">(</span><span class="va">ymin</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">stat</a></span><span class="op">(</span><span class="va">ymax</span><span class="op">)</span> <span class="op">~</span> <span class="va">sex</span>, </span>
<span>                color <span class="op">=</span> <span class="op">~</span> <span class="va">domhand</span>, group <span class="op">=</span> <span class="op">~</span> <span class="va">domhand</span>, stat<span class="op">=</span><span class="st">"summary"</span><span class="op">)</span></span>
<span><span class="co">#&gt; No summary function supplied, defaulting to `mean_se()`</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/stats03-1.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_jitter.html">gf_jitter</a></span><span class="op">(</span><span class="va">body_mass_g</span> <span class="op">~</span> <span class="va">sex</span>, color <span class="op">=</span> <span class="op">~</span> <span class="va">species</span>, width <span class="op">=</span> <span class="fl">0.1</span>, height <span class="op">=</span> <span class="fl">0</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gf_linerange.html">gf_pointrange</a></span><span class="op">(</span><span class="va">body_mass_g</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">stat</a></span><span class="op">(</span><span class="va">ymin</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">stat</a></span><span class="op">(</span><span class="va">ymax</span><span class="op">)</span> <span class="op">~</span> <span class="va">sex</span>, color <span class="op">=</span> <span class="op">~</span> <span class="va">species</span>, </span>
<span>                group <span class="op">=</span> <span class="op">~</span> <span class="va">species</span>, size <span class="op">=</span> <span class="fl">1.5</span>, stat<span class="op">=</span><span class="st">"summary"</span><span class="op">)</span></span>
<span><span class="co">#&gt; No summary function supplied, defaulting to `mean_se()`</span></span>
<span><span class="co">#&gt; Warning: Removed 2 rows containing non-finite outside the scale range</span></span>
<span><span class="co">#&gt; (`stat_summary()`).</span></span>
<span><span class="co">#&gt; Warning: Removed 2 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/stats03-2.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>Custom functions can be used by defining <code>fun.y</code>, <code>fun.ymin</code>, and <code>fun.ymax</code>, or a single function <code>fun.data</code> that returns a data frame with variables named <code>y</code>, <code>ymin</code>, and <code>ymax</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">KidsFeet</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_point.html">gf_point</a></span><span class="op">(</span><span class="va">length</span> <span class="op">~</span> <span class="va">sex</span>, color <span class="op">=</span> <span class="op">~</span> <span class="va">domhand</span>, width <span class="op">=</span> <span class="fl">0.1</span>, height <span class="op">=</span> <span class="fl">0</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>           position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitterdodge.html" class="external-link">position_jitterdodge</a></span><span class="op">(</span>jitter.width <span class="op">=</span> <span class="fl">0.2</span>, dodge.width <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gf_linerange.html">gf_pointrange</a></span><span class="op">(</span><span class="va">length</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">stat</a></span><span class="op">(</span><span class="va">ymin</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">stat</a></span><span class="op">(</span><span class="va">ymax</span><span class="op">)</span> <span class="op">~</span> <span class="va">sex</span>, </span>
<span>                color <span class="op">=</span> <span class="op">~</span> <span class="va">domhand</span>, group <span class="op">=</span> <span class="op">~</span> <span class="va">domhand</span>, stat<span class="op">=</span><span class="st">"summary"</span>,</span>
<span>                fun.y <span class="op">=</span> <span class="va">median</span>, fun.ymin <span class="op">=</span> <span class="va">min</span>, fun.ymax <span class="op">=</span> <span class="va">max</span>,</span>
<span>                position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span>
<span><span class="co">#&gt; No summary function supplied, defaulting to `mean_se()`</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/stats04-1.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
</section><section class="level3"><h4 id="plotting-functions">Plotting functions<a class="anchor" aria-label="anchor" href="#plotting-functions"></a>
</h4>
<p><code>ggformula</code> provides two way to plot functions: <code><a href="../reference/gf_function.html">gf_function()</a></code> and <code><a href="../reference/gf_function.html">gf_fun()</a></code>. They differ primarily in how one specifies the function to be plotted.</p>
<ul>
<li>
<code><a href="../reference/gf_function.html">gf_function()</a></code> requires a (vectorized) function of one variable.</li>
<li>
<code><a href="../reference/gf_function.html">gf_fun()</a></code> requires a formula describing how the y-values are computed from the x-values.</li>
</ul>
<p>If these are used as a first layer, the limits for the x-axis must be specified.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gf_function.html">gf_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">sqrt</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gf_function.html">gf_fun</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">3</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="fl">10</span> <span class="op">*</span> <span class="va">x</span><span class="op">)</span> <span class="op">~</span> <span class="va">x</span>, color <span class="op">=</span> <span class="st">"red"</span>, n <span class="op">=</span> <span class="fl">800</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/functions-1.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mosaicCore/man/makeFun.html" class="external-link">makeFun</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">totalbill</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html" class="external-link">poly</a></span><span class="op">(</span><span class="va">month</span>, <span class="fl">2</span><span class="op">)</span>, data <span class="op">=</span> <span class="fu">mosaicData</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/mosaicData/man/Utilities.html" class="external-link">Utilities</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">mosaicData</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/mosaicData/man/Utilities.html" class="external-link">Utilities</a></span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu"><a href="../reference/gf_point.html">gf_point</a></span><span class="op">(</span><span class="va">totalbill</span> <span class="op">~</span> <span class="va">month</span>, alpha <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gf_function.html">gf_fun</a></span><span class="op">(</span><span class="fu">f</span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="op">~</span> <span class="va">m</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/functions-2.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
</section></section><section class="level2"><h3 id="maps">Maps<a class="anchor" aria-label="anchor" href="#maps"></a>
</h3>
<p>Prior to <code>ggplot2</code> version 2.3, basic maps could be created using <code><a href="../reference/gf_polygon.html">gf_polygon()</a></code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/adeckmyn/maps" class="external-link">maps</a></span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">US</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/map_data.html" class="external-link">map_data</a></span><span class="op">(</span><span class="st">"state"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>name_length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">region</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">States</span> <span class="op">&lt;-</span> <span class="va">US</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">region</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">lat</span><span class="op">)</span><span class="op">)</span>, long <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">long</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/abbreviate.html" class="external-link">abbreviate</a></span><span class="op">(</span><span class="va">region</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="../reference/gf_polygon.html">gf_polygon</a></span><span class="op">(</span><span class="va">lat</span> <span class="op">~</span> <span class="va">long</span>, data <span class="op">=</span> <span class="va">US</span>, group <span class="op">=</span> <span class="op">~</span> <span class="va">group</span>,</span>
<span>             fill <span class="op">=</span> <span class="op">~</span> <span class="va">name_length</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gf_text.html">gf_text</a></span><span class="op">(</span><span class="va">lat</span> <span class="op">~</span> <span class="va">long</span>, label <span class="op">=</span> <span class="op">~</span> <span class="va">name</span>, data <span class="op">=</span> <span class="va">States</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"gray70"</span>, inherit <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gf_aux.html">gf_refine</a></span><span class="op">(</span><span class="fu">mosaic</span><span class="fu">::</span><span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/theme_map.html" class="external-link">theme_map</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/unnamed-chunk-7-1.png" class="quarto-figure quarto-figure-center" style="width:75.0%"></p>
</figure>
</div>
</div>
</div>
<p>Starting with <code>ggplot2</code> version 2.3, there is direct support for shape files. This allows each row of a data frame to contain all the geometry information for a region in a single column. There is also better support for overlaying information from multiple shape files.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/adeckmyn/maps" class="external-link">maps</a></span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">USshape</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="fu">maps</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/maps/man/map.html" class="external-link">map</a></span><span class="op">(</span><span class="st">'state'</span>, plot <span class="op">=</span> <span class="cn">FALSE</span>, fill <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>      name_length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">ID</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      centroid <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">geom</span>, <span class="va">st_centroid</span><span class="op">)</span>,</span>
<span>      coords_x <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_dbl</a></span><span class="op">(</span><span class="va">centroid</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>      coords_y <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_dbl</a></span><span class="op">(</span><span class="va">centroid</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="op">)</span> </span>
<span>    </span>
<span>  <span class="fu"><a href="../reference/gf_sf.html">gf_sf</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">name_length</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"white"</span>, data <span class="op">=</span> <span class="va">USshape</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../reference/gf_text.html">gf_text</a></span><span class="op">(</span><span class="va">coords_y</span> <span class="op">~</span> <span class="va">coords_x</span>, label <span class="op">=</span> <span class="op">~</span> <span class="va">ID</span>, color <span class="op">=</span> <span class="st">"gray20"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../reference/gf_aux.html">gf_labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../reference/gf_aux.html">gf_refine</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../reference/gf_theme.html">gf_theme</a></span><span class="op">(</span><span class="fu">mosaic</span><span class="fu">::</span><span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/theme_map.html" class="external-link">theme_map</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../reference/gf_aux.html">gf_labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"name length"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/unnamed-chunk-8-1.png" class="quarto-figure quarto-figure-center" style="width:75.0%"></p>
</figure>
</div>
</div>
</div>
<pre><code>&lt;!-- # gf_sf(data = sf::st_centroid(USshape), color = "white", alpha = 0.5, size = 3) |&gt; --&gt;</code></pre>
</section><section class="level2"><h3 id="new-types-of-plots">New types of plots<a class="anchor" aria-label="anchor" href="#new-types-of-plots"></a>
</h3>
<p><code>ggformula</code> adds some additional plot options to <code>ggplot2</code></p>
<section class="level3"><h4 id="ash-plots">ASH plots<a class="anchor" aria-label="anchor" href="#ash-plots"></a>
</h4>
<p>Average shifted histograms can be created with <code><a href="../reference/gf_ash.html">gf_ash()</a></code>. These plots average the height over all histograms with the same bin width. ASH plots often work well with larger bin widths than you might use for an individual histogram.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">HELPrct</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_ash.html">gf_ash</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">age</span>, data <span class="op">=</span> <span class="va">HELPrct</span>, binwidth <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gf_histogram.html">gf_dhistogram</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">age</span>, binwidth <span class="op">=</span> <span class="fl">2</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> </span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/unnamed-chunk-9-1.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">HELPrct</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_ash.html">gf_ash</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">age</span>, binwidth <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_histogram.html">gf_dhistogram</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">age</span>, binwidth <span class="op">=</span> <span class="fl">2</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> </span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/unnamed-chunk-9-2.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
</section><section class="level3"><h4 id="distribution-plots">Distribution plots<a class="anchor" aria-label="anchor" href="#distribution-plots"></a>
</h4>
<p><code><a href="../reference/gf_dist.html">gf_dist()</a></code> can be used to create plots of discrete and continuous distributions.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gf_dist.html">gf_dist</a></span><span class="op">(</span><span class="st">"pois"</span>, lambda <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/unnamed-chunk-10-1.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gf_dist.html">gf_dist</a></span><span class="op">(</span><span class="st">"pois"</span>, lambda <span class="op">=</span> <span class="fl">5</span>, kind <span class="op">=</span> <span class="st">"cdf"</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/unnamed-chunk-10-2.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gf_dist.html">gf_dist</a></span><span class="op">(</span><span class="st">"gamma"</span>, shape <span class="op">=</span> <span class="fl">3</span>, rate <span class="op">=</span> <span class="fl">4</span>, geom <span class="op">=</span> <span class="st">"area"</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/unnamed-chunk-10-3.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gf_dist.html">gf_dist</a></span><span class="op">(</span><span class="st">"gamma"</span>, shape <span class="op">=</span> <span class="fl">3</span>, rate <span class="op">=</span> <span class="fl">4</span>, geom <span class="op">=</span> <span class="st">"area"</span>, fill <span class="op">=</span> <span class="op">~</span> <span class="op">(</span><span class="va">x</span> <span class="op">&lt;=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/unnamed-chunk-10-4.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gf_dist.html">gf_dist</a></span><span class="op">(</span><span class="st">"gamma"</span>, shape <span class="op">=</span> <span class="fl">3</span>, rate <span class="op">=</span> <span class="fl">4</span>, kind <span class="op">=</span> <span class="st">"cdf"</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/unnamed-chunk-10-5.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>When distribution parameters and plot attributes have the same name, there are two ways to avoid the name collision:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># size is used by the binomial distribution functions and when plotting</span></span>
<span><span class="fu"><a href="../reference/gf_dist.html">gf_dist</a></span><span class="op">(</span><span class="st">"binom"</span>, size <span class="op">=</span> <span class="fl">20</span>, prob <span class="op">=</span> <span class="fl">0.25</span>, plot_size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/unnamed-chunk-11-1.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gf_dist.html">gf_dist</a></span><span class="op">(</span><span class="st">"binom"</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">20</span>, prob <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/unnamed-chunk-11-2.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p><code>ggformula</code> also provides an interface to <code><a href="https://rdrr.io/pkg/MASS/man/fitdistr.html" class="external-link">MASS::fitdistr()</a></code> for fitting distributions to data and displaying the resulting pdf.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="fl">1000</span>, shape <span class="op">=</span> <span class="fl">2</span>, rate <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/gf_histogram.html">gf_dhistogram</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">x</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gf_fitdistr.html">gf_fitdistr</a></span><span class="op">(</span>dist <span class="op">=</span> <span class="st">"dnorm"</span>, color <span class="op">=</span> <span class="op">~</span> <span class="st">"Normal"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_fitdistr.html">gf_fitdistr</a></span><span class="op">(</span>dist <span class="op">=</span> <span class="st">"dgamma"</span>, color <span class="op">=</span> <span class="op">~</span> <span class="st">"Gamma"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gf_fitdistr.html">gf_fitdistr</a></span><span class="op">(</span>dist <span class="op">=</span> <span class="st">"dweibull"</span>, color <span class="op">=</span> <span class="op">~</span> <span class="st">"Weibull"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_aux.html">gf_labs</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value `binwidth`.</span></span>
<span><span class="co">#&gt; Warning in densfun(x, parm[1], parm[2], ...): NaNs produced</span></span>
<span><span class="co">#&gt; Warning in densfun(x, parm[1], parm[2], ...): NaNs produced</span></span>
<span><span class="co">#&gt; Warning in densfun(x, parm[1], parm[2], ...): NaNs produced</span></span>
<span><span class="co">#&gt; Warning in densfun(x, parm[1], parm[2], ...): NaNs produced</span></span>
<span><span class="co">#&gt; Warning in densfun(x, parm[1], parm[2], ...): NaNs produced</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/unnamed-chunk-12-1.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
</section></section><section class="level2"><h3 id="global-plot-adjustments">Global plot adjustments<a class="anchor" aria-label="anchor" href="#global-plot-adjustments"></a>
</h3>
<p>There are a number of things we may want to do to the entire plot – adjusting labels, colors, fonts, etc. <code>ggformula</code> provides wrappers to the <code>ggplot2</code> functions for this so that the chaining syntax can be used.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_histogram.html">gf_histogram</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">body_mass_g</span>, alpha <span class="op">=</span> <span class="fl">0.2</span>, fill <span class="op">=</span> <span class="st">"navy"</span>,</span>
<span>              color <span class="op">=</span> <span class="st">"gray50"</span>, binwidth <span class="op">=</span> <span class="fl">200</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gf_freqpoly.html">gf_freqpoly</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">body_mass_g</span>, binwidth <span class="op">=</span> <span class="fl">200</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gf_facet_grid.html">gf_facet_grid</a></span><span class="op">(</span><span class="va">species</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_aux.html">gf_labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"bill length (mm)"</span>, title <span class="op">=</span> <span class="st">"Palmer Penguins"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gf_aux.html">gf_lims</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2500</span>, <span class="fl">6500</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_theme.html">gf_theme</a></span><span class="op">(</span>theme <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 2 rows containing non-finite outside the scale range (`stat_bin()`).</span></span>
<span><span class="co">#&gt; Removed 2 rows containing non-finite outside the scale range (`stat_bin()`).</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/themes-1.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_histogram.html">gf_histogram</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">body_mass_g</span> <span class="op">|</span> <span class="va">species</span> <span class="op">~</span> <span class="va">.</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, fill <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>              binwidth <span class="op">=</span> <span class="fl">200</span>, color <span class="op">=</span> <span class="st">"gray40"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gf_freqpoly.html">gf_freqpoly</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">body_mass_g</span>, color <span class="op">=</span> <span class="st">"skyblue"</span>, </span>
<span>               binwidth <span class="op">=</span> <span class="fl">200</span>, size <span class="op">=</span> <span class="fl">1.2</span>, alpha <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gf_aux.html">gf_labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"bill length (mm)"</span>, title <span class="op">=</span> <span class="st">"Palmer Penguins"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gf_aux.html">gf_lims</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2500</span>, <span class="fl">6500</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_theme.html">gf_theme</a></span><span class="op">(</span>theme <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_dark</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.</span></span>
<span><span class="co">#&gt; ℹ Please use `linewidth` instead.</span></span>
<span><span class="co">#&gt; Removed 2 rows containing non-finite outside the scale range (`stat_bin()`).</span></span>
<span><span class="co">#&gt; Removed 2 rows containing non-finite outside the scale range (`stat_bin()`).</span></span>
<span><span class="co">#&gt; ℹ The deprecated feature was likely used in the base package.</span></span>
<span><span class="co">#&gt;   Please report the issue to the authors.</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/themes-2.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>For convenience, a few modifications can also be made directly in the original function call:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gf_histogram.html">gf_dhistogram</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">body_mass_g</span> <span class="op">|</span> <span class="va">species</span> <span class="op">~</span> <span class="va">.</span>, </span>
<span>                alpha <span class="op">=</span> <span class="fl">0.5</span>, fill <span class="op">=</span> <span class="st">"skyblue"</span>, color <span class="op">=</span> <span class="st">"navy"</span>, binwidth <span class="op">=</span> <span class="fl">200</span>, </span>
<span>                xlab <span class="op">=</span> <span class="st">"body mass (g)"</span>, title <span class="op">=</span> <span class="st">"Palmer Penguins"</span></span>
<span>  <span class="op">)</span> </span>
<span><span class="co">#&gt; Warning: Removed 2 rows containing non-finite outside the scale range</span></span>
<span><span class="co">#&gt; (`stat_bin()`).</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/unnamed-chunk-13-1.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
</section><section class="level2"><h3 id="horizontal-geoms">Horizontal Geoms<a class="anchor" aria-label="anchor" href="#horizontal-geoms"></a>
</h3>
<p>Some of the geoms in ggplot2 can have either a horizontal or vertical direction. Often ggplot2 will correctly determine which orientation is intended. If not, set <code>orientation = 'x'</code> or <code>orientation = 'y'</code> to explicitly set the direction of the geom.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gf_boxplot.html">gf_boxplot</a></span><span class="op">(</span><span class="va">high_temp</span> <span class="op">~</span> <span class="va">city</span>, data <span class="op">=</span> <span class="va">Weather</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/unnamed-chunk-14-1.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># auto-detected because city is discrete</span></span>
<span><span class="fu"><a href="../reference/gf_boxplot.html">gf_boxplot</a></span><span class="op">(</span><span class="va">city</span> <span class="op">~</span> <span class="va">high_temp</span>, data <span class="op">=</span> <span class="va">Weather</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/unnamed-chunk-14-2.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># auto-detected based on groups</span></span>
<span><span class="fu"><a href="../reference/gf_boxplot.html">gf_boxplot</a></span><span class="op">(</span><span class="va">month</span> <span class="op">~</span> <span class="va">high_temp</span> <span class="op">|</span> <span class="op">~</span> <span class="va">city</span>, group <span class="op">=</span> <span class="op">~</span> <span class="va">month</span>, data <span class="op">=</span> <span class="va">Weather</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/unnamed-chunk-14-3.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gf_boxplot.html">gf_boxplot</a></span><span class="op">(</span><span class="va">high_temp</span> <span class="op">~</span> <span class="va">month</span> <span class="op">|</span> <span class="va">city</span> <span class="op">~</span> <span class="va">.</span>, group <span class="op">=</span> <span class="op">~</span> <span class="va">month</span>, data <span class="op">=</span> <span class="va">Weather</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/unnamed-chunk-14-4.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># defaults to veritcal without groups </span></span>
<span><span class="fu"><a href="../reference/gf_boxplot.html">gf_boxplot</a></span><span class="op">(</span><span class="va">month</span> <span class="op">~</span> <span class="va">high_temp</span> <span class="op">|</span> <span class="op">~</span> <span class="va">city</span>, data <span class="op">=</span> <span class="va">Weather</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Continuous x aesthetic</span></span>
<span><span class="co">#&gt; ℹ did you forget `aes(group = ...)`?</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/unnamed-chunk-14-5.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># explicit horizontal orientation</span></span>
<span><span class="fu"><a href="../reference/gf_boxplot.html">gf_boxplot</a></span><span class="op">(</span><span class="va">month</span> <span class="op">~</span> <span class="va">high_temp</span> <span class="op">|</span> <span class="va">city</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">Weather</span>, orientation <span class="op">=</span> <span class="st">'y'</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Continuous y aesthetic</span></span>
<span><span class="co">#&gt; ℹ did you forget `aes(group = ...)`?</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ggformula-long_files/figure-html/unnamed-chunk-14-6.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
</section></section><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'light-border',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config);
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Daniel Kaplan, Randall Pruim.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
